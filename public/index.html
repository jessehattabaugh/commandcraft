<!DOCTYPE html>
<html>
<head>
  <title>CommandCraft</title>
  <style type="text/css">
    section:not(:last-child) {
      border-bottom: 1px solid gray;
      margin-bottom: 1em;
    }
    input[type=number]{
      width: 3em;
    }
  </style>
</head>
<body>
    
  <!-- Command picker --------------------------------------------------------->
  <section>
    <label>Command
      <select data-bind="
        options: commands,
        optionsText: 'id',
        value: command
      "></select>
    </label>
  </section>
  
  <!-- Entity Picker ---------------------------------------------------------->
  <!-- ko if: command().id === 'summon' -->
    <section>
      <label>Entity
        <select data-bind="
          options: entities,
          optionsText: 'name',
          value: entity
        "></select>
      </label>
    </section>
  <!-- /ko -->
  
  <!-- Coordinate Picker ------------------------------------------------------>
  <!-- ko if: command().id === 'summon' -->
    <section>
      <fieldset>
        <legend>Coordinates</legend>
        
        <div>
          <label>X
            <input type="number" data-bind="value: x">
          </label>
          <label>
            <input type="checkbox" data-bind="checked: x.rel"> relative
          </label>
        </div>
        
        <div>
          <label>Y
            <input type="number" min="0" max="256" data-bind="value: y">
          </label>
          <label>
            <input type="checkbox" data-bind="checked: y.rel"> relative
          </label>
        </div>
        
        <div>
          <label>Z
            <input type="number" data-bind="value: z">
          </label>
          <label>
            <input type="checkbox" data-bind="checked: z.rel"> relative
          </label>
        </div>
        
      </fieldset>
    </section>
  <!-- /ko -->
  
  <!-- Player picker ---------------------------------------------------------->
  <!-- ko if: command().id === 'give' -->
    <section>
      <label>Player
        <input data-bind="
          value: playerName,
          event: {keydown: function () {
            playerVar('');
            return true;
          }}
        ">
        <select data-bind="
          options: variables,
          optionsText: 'name',
          value: playerVar,
          optionsCaption: '-',
          event: {change: function () {
            playerName('');
          }}
          "></select>
      </label>
    </section>
  <!-- /ko -->
  
  <!-- Item Picker ------------------------------------------------------------>
  <!-- ko if: command().id === 'give' -->
    <section>
      <label>Item
        <select data-bind="
          options: items,
          optionsText: 'name',
          value: item
        "></select>
      </label>
    </section>
  <!-- /ko -->
  
  <!-- Amount input ----------------------------------------------------------->
  <!-- ko if: command().id === 'give' -->
    <section>
      <label>Amount
        <input type="number" min="1" max="64" data-bind="value: amount">
      </label>
    </section>
  <!-- /ko -->
  
  <!-- Metadata input --------------------------------------------------------->
  <!-- ko if: command().id === 'give' -->
    <section>
      <label>Metadata
        <input type="number" min="0" max="256" data-bind="value: metadata">
      </label>
    </section>
  <!-- /ko -->
  
  <!-- Tag builder ------------------------------------------------------------>
  <section>
    <label>Tag</label>
    <ul data-bind="template: {name: 'tagTemplate', data: tag}"></ul>
  </section>
  
  <!-- Tag Template ----------------------------------------------------------->
  <script type="text/html" id="tagTemplate">
    <li data-bind="attr:{title: data.description}">
      
      <!-- ko if: parent !== null -->
        <input type="button" value="x" data-bind="click: removeSelf">
      <!-- /ko -->
      
      <!-- ko if: data.id -->
        <label data-bind="text: data.id"></label>
      <!-- /ko -->
      
      <!-- ko if: data.type === 'string' -->
        <input data-bind="value: value">
      <!-- /ko -->
      
      <!-- ko if: data.type === 'value' -->
        <select data-bind="
          options: values,
          optionsText: function (option) {
            return option.label ? option.label : option.name;
          },
          value: value
        "></select>
      <!-- /ko -->
      
      <!-- ko if: data.type === 'number' -->
        <input type="number" data-bind="value: value">
      <!-- /ko -->
      
      <!-- ko if: data.type === 'boolean' -->
        <label>true <input type="radio" value="true" data-bind="trueOrFalse: value"></label>
        <label>false <input type="radio" value="false" data-bind="trueOrFalse: value"></label>
      <!-- /ko -->
      
      <!-- ko if: data.type === 'list' || data.type === 'compound' -->
        <ul data-bind="template: {name: 'tagTemplate', foreach: children}"></ul>
        
        <select data-bind="
          options: options,
          optionsText: 'id',
          value: selected,
          visible: canAdd()
        "></select>
        
        <input type="button" value="add" data-bind="
          click: addChild,
          visible: canAdd()
        ">
      <!-- /ko -->
      
      
    </li>
  </script>
  
  <!-- Output ----------------------------------------------------------------->
  <section>
    <label>Output
      <textarea style="width: 100%; height: 10em" data-bind="text: output"></textarea>
    </label>
  </section>
  
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.0.0/knockout-min.js"></script>
  <script type="text/javascript" src="bindingHandlers.js"></script>
  <script type="text/javascript" src="tag.js"></script>
  <script type="text/javascript" src="view.js"></script>
  <script type="text/javascript">
    // init
    $(function onDomReady(){
      var view = new View();
      ko.applyBindings(view);
    });
  </script>
</body>
</html>